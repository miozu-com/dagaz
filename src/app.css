/* src/app.css - Updating key typography and code highlighting styles */

@import 'tailwindcss';
@variant dark (&:where(.dark, .dark *));
@import './theme.css';

/* Add typography improvements */
html {
  @apply overflow-hidden;
  @apply text-base5 dark:text-base7 bg-base0 dark:bg-base0;
  /* Typography improvements */
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

body {
  @apply bg-base0 dark:bg-base0 text-base5 dark:text-base7;
  /* Improved line height for better readability */
  line-height: 1.6;
  letter-spacing: -0.011em;
}

/* Scrollbar improvements */
::-webkit-scrollbar {
  width: 6px; /* Thin scrollbar width */
  height: 6px; /* For horizontal scrollbars */
}

::-webkit-scrollbar-thumb {
  @apply bg-base3/50; /* Thumb (scrollbar handle) color */
  border: 1px solid transparent; /* Adds spacing inside the track */
  border-radius: 4px; /* Rounded edges */
  background-clip: padding-box; /* Ensures the thumb respects the border */
}

::-webkit-scrollbar-track {
  @apply bg-base1/50; /* Track (background) color */
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  @apply bg-base4/60;
}

:global(.dark) ::-webkit-scrollbar-thumb {
  @apply bg-base4/60;
}

:global(.dark) ::-webkit-scrollbar-track {
  @apply bg-base1/60;
}

:global(.dark) ::-webkit-scrollbar-thumb:hover {
  @apply bg-base5/60;
}

/* Selection highlighting */
*::selection {
  @apply text-base0 bg-base14/80 dark:text-base0 dark:bg-base14/80;
}

/* Enhanced Miozu theme color variables for Shiki syntax highlighting */
:root {
  /* Base colors */
  --shiki-color-text: var(--color-base7); /* Main text in code blocks */
  --shiki-color-background: var(--color-base1); /* Background of code blocks */

  /* Primary token colors - Enhanced for better readability */
  --shiki-token-constant: var(--color-base13); /* Purple for constants/objects like "browser" */
  --shiki-token-string: var(--color-base10); /* Bright green for strings */
  --shiki-token-comment: var(--color-base4); /* Dimmer gray for comments */
  --shiki-token-keyword: var(
    --color-base14
  ); /* Peachy/orange color for keywords like import/export/const */
  --shiki-token-parameter: var(--color-base7); /* Light gray/white for parameters */
  --shiki-token-function: var(--color-base13); /* Purple/magenta for function declarations */
  --shiki-token-string-expression: var(--color-base10); /* Green for string expressions */
  --shiki-token-punctuation: var(--color-base6); /* Light gray for punctuation */
  --shiki-token-link: var(--color-base15); /* Cyan for links */

  /* Additional token types - Adjusted for better readability */
  --shiki-token-variable: var(--color-base7); /* Light gray/white for most variables */
  --shiki-token-property: var(--color-base15); /* Cyan for properties like .localStorage */
  --shiki-token-operator: var(--color-base7); /* White for operators like => */
  --shiki-token-boolean: var(--color-base9); /* Orange for true/false */
  --shiki-token-number: var(--color-base9); /* Orange for numbers */

  /* HTML/JSX specific */
  --shiki-token-tag: var(--color-base14); /* Peachy for HTML tags */
  --shiki-token-attr-name: var(--color-base10); /* Green for HTML attributes */
  --shiki-token-attr-value: var(--color-base10); /* Green for attribute values */

  /* Class names in HTML/component context */
  --shiki-token-class-name: var(--color-base10); /* Green for class names */

  /* Method invocations */
  --shiki-token-method: var(--color-base15); /* Cyan for method calls like .getItem */

  /* Special tokens */
  --shiki-token-regex: var(--color-base10); /* Green for regex */
  --shiki-token-escape: var(--color-base9); /* Orange for escape sequences */

  /* Additional semantic tokens */
  --shiki-token-inserted: var(--color-base10); /* Green */
  --shiki-token-deleted: var(--color-base8); /* Red */
  --shiki-token-changed: var(--color-base11); /* Yellow */
  --shiki-token-error: var(--color-base8); /* Red */

  /* CSS specific */
  --shiki-token-selector: var(--color-base14); /* Peachy for CSS selectors */
  --shiki-token-property-css: var(--color-base10); /* Green for CSS properties */
  --shiki-token-value-css: var(--color-base7); /* White for CSS values */

  /* JSON specific */
  --shiki-token-json-property: var(--color-base15); /* Cyan for JSON property names */

  /* Svelte specific tokens - Enhanced colors */
  --shiki-token-svelte-tag: var(--color-base14); /* Svelte component tags */
  --shiki-token-svelte-directive: var(--color-base13); /* Svelte directives like bind:, on:, etc. */
  --shiki-token-svelte-expression: var(--color-base15); /* Expressions in {} */
  --shiki-token-svelte-control: var(--color-base14); /* Control flow like #if, #each */

  /* Svelte 5 runes - More visible */
  --shiki-token-svelte-rune: var(--color-base14); /* Svelte 5 runes like $state, $derived */
  --shiki-token-keyword-rune-svelte: var(--color-base14); /* For the custom grammar rule */

  /* Component element colors */
  --shiki-token-component-tag: var(--color-base13); /* Svelte component name */
}

/* Code highlighting specifics for blog posts */
:global(.post-body) {
  :global(pre) {
    @apply rounded-lg my-6;
    @apply bg-base1 dark:bg-base1;
    @apply border border-base3/10;
    @apply shadow-sm;
    @apply relative;
  }

  :global(pre code) {
    @apply font-mono text-base6;
    font-size: 0.94rem;
    line-height: 1.6;
    padding: 1.25rem !important;
  }

  /* Add language label to code blocks */
  :global(pre::before) {
    content: attr(data-language);
    @apply absolute top-0 right-0 px-3 py-1 text-xs font-mono;
    @apply bg-base2/70 text-base5 rounded-bl-md rounded-tr-md;
    @apply uppercase tracking-wider;
  }

  /* Svelte code block improvements */
  :global(.language-svelte) {
    :global(.tag) {
      color: var(--color-base14);
      font-weight: 600;
    }

    :global(.attr-name) {
      color: var(--color-base10);
    }

    :global(.attr-value) {
      color: var(--color-base10);
    }

    :global(.punctuation) {
      color: var(--color-base6);
    }

    /* Svelte 5 runes */
    :global(.keyword:has(+ .punctuation:contains('$'))) {
      color: var(--color-base14);
      font-weight: 600;
    }

    :global(.script-tag) {
      color: var(--color-base14);
      font-weight: 600;
    }

    :global(.style-tag) {
      color: var(--color-base14);
      font-weight: 600;
    }
  }

  /* JavaScript improvements */
  :global(.language-javascript),
  :global(.language-js) {
    :global(.keyword) {
      color: var(--color-base14);
      font-weight: 600;
    }

    :global(.function) {
      color: var(--color-base13);
    }

    :global(.string) {
      color: var(--color-base10);
    }

    :global(.number) {
      color: var(--color-base9);
    }

    :global(.comment) {
      color: var(--color-base4);
      font-style: italic;
    }
  }
}

/* TAB */
.tabs {
  @apply flex gap-1;
}

.tab {
  @apply relative flex items-center gap-2.5;
  @apply border-b-3 border-transparent transition-all font-medium;
  @apply text-base4 dark:text-base4;
  @apply cursor-pointer;
  @apply pl-8 pr-4 pb-2 pt-1.5;
}

.tab::before {
  content: '';
  @apply absolute h-2 w-2 rounded-full left-3 bg-transparent;
  transition: all 0.3s ease;
}

.tab:hover::before {
  @apply bg-base3 dark:bg-base4;
}

.tab.active {
  @apply bg-base1/55 dark:bg-base2/55 text-base7 dark:text-base7;
  border-image: linear-gradient(to right, #6c76f1 0%, #8165d8 100%) 1;
}

.tab.active::before {
  background-color: #6c76f1;
}

.tab.active:hover {
  @apply text-base7/90 dark:text-base7/90;
}

.tab:hover {
  @apply bg-base2/10 dark:bg-base2/20 text-base6/60 dark:text-base6/70;
}

.tab-count {
  @apply text-sm self-center;
}

/* Add custom utility classes for typography */
.typography-article {
  @apply font-serif text-lg text-base6 leading-relaxed;
  @apply tracking-normal;
}

.typography-heading {
  @apply font-sans font-bold tracking-tight text-base14;
}

.typography-heading-1 {
  @apply text-4xl leading-tight;
  @apply tracking-tight;
}

.typography-heading-2 {
  @apply text-3xl leading-tight;
  @apply tracking-tight;
}

.typography-heading-3 {
  @apply text-2xl leading-tight;
  @apply tracking-tight;
}

.typography-heading-4 {
  @apply text-xl leading-tight;
  @apply tracking-tight;
}

.typography-subheading {
  @apply font-sans font-medium text-base3 text-sm uppercase;
  @apply tracking-wider;
}

.typography-caption {
  @apply font-sans text-sm text-base4;
}
